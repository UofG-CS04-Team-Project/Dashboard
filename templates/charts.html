{% extends 'base.html' %}
{% block content %}

<body>
<div class = "col-md-10 col-12 mx-auto" style="margin-top:50px">
	<div class="row">
		<div class="col-md-6 col-12">
			<div class = "card" style="margin-top:30px"> 
				<div class = "card-body" > 
					<canvas id = "Chart1" width="300" height="400"></canvas>
					<input onchange = "filterData()" type="date" id="startDate">
					<input onchange = "filterData()" type="time" id="startTime">
					<input onchange = "filterData()" type="date" id="endDate">
					<input onchange = "filterData()" type="time" id="endTime">
				</div> 
			</div> 
		</div>
		<div class="col-md-6 col-12">
			<div class = "card" style="margin-top:30px"> 
				<div class = "card-body"> 
					<canvas id = "ChartHumidity" width="300" height="400">
					</canvas>

				</div> 
			</div> 
		</div>
	</div>
	<div class="row">
		<div class="col-md-6 col-12">
			<div class = "card" style="margin-top:30px"> 
				<div class = "card-body"> 
					<canvas id = "ChartTemperature" width="300" height="400"></canvas>
				</div> 
			</div> 
		</div>
		<div class="col-md-6 col-12">
			<div class = "card" style="margin-top:30px"> 
				<div class = "card-body"> 
					<canvas id = "ChartOccupancy" width="300" height="400">
					</canvas>
					
				</div> 
			</div> 
		</div>
	</div>
</div>
</body>
<script>
	var humidity_data;
	var temperature_data;
	var occupancy_data;
	$(document).ready(MakeCharts)
	function MakeCharts(){
		$.ajax({
			url: window.location.pathname,
			success: function(response){
				humidity_data = [response["humidity_data"][0], response["humidity_data"][1]];
				temperature_data = [response["temperature_data"][0], response["temperature_data"][1]];
				occupancy_data = [response["occupancy_data"][0], response["occupancy_data"][1]];

				MakeChart(humidity_data[0], humidity_data[1], "ChartHumidity", "Humidity");
				MakeChart(temperature_data[0], temperature_data[1], "ChartTemperature", "Temperature");
				MakeChart(occupancy_data[0], occupancy_data[1], "ChartOccupancy", "Occupancy");

			},
			complete: function(){
				setTimeout(MakeCharts, 60000);
			}
			
		});
	};
	function MakeChart(values, times, canvasID, chartName){
		var ctx = document.getElementById(canvasID);
		var NewChart = new Chart(ctx,{
			type: 'line',
			data: {
				labels: times,
				datasets: [{
					label: chartName,
					data: values,
				}]
			},

		});
	};

	function filterData(){

		var humidity_values = [...humidity_data[0]];
		var temperature_values = [...temperature_data[0]];
		var occupancy_values = [...occupancy_data[0]];

		var humidity_time = [...humidity_data[1]];
		var temperature_time = [...temperature_data[1]];
		var occupancy_time = [...occupancy_data[1]];
		
		const startDate = document.getElementById('startDate');
		const startTime = document.getElementById('startTime');
		const endDate = document.getElementById('endDate');
		const endTime = document.getElementById('endTime');

		const indexStartDate = dates.indexOf(startDate.value);
		const indexStartTime = dates.indexOf(startTime.value);
		const indexEndDate = dates.indexOf(endDate.value);
		const indexEndTime = dates.indexOf(endTime.value);



		


	}

</script>
{% endblock content %}
